<div *ngIf="isLoading">
  <app-notifications></app-notifications>
  
</div>

<div class="main-content" *ngIf="!isLoading" >
  <div class="container-fluid">
    <div *ngIf= "loading && MeassageError && MeassageError.length>0">
      Error create cube ...
    </div>
    <div *ngIf= "loading && MeassageError && MeassageError.length == 0">
      cube created succes ...   
      <img src="../../assets/img/faces/1436013803checkbox-1024x1024.webp"/>
      <button   class="btn btn-primary btn-lg btn-block" (click)="reset()">OK</button>
     </div>
  <div *ngIf= "loading && !MeassageError" >
    <app-maps></app-maps>
  </div>
  <div *ngIf="!loading">
    <mat-label style="color:black;font-size: 20px;"> Choose a Server Name  </mat-label>
    <mat-form-field >
      <mat-select  id="selectedServerId" [(ngModel)]="selectedServerId" [compareWith]="comparer" >
        <mat-option *ngFor="let obj  of liste_des_serveur " [value]="obj" (click)="setserveur(obj.Id)">
           {{ obj.Name }} 
        </mat-option>
      </mat-select>
    </mat-form-field>
<br>
    <mat-label style="color:black;font-size: 20px;">Choose data base  </mat-label>
    <mat-form-field >
     
      <mat-select  id="database-select" [(ngModel)]="selectedDatabase" required>
        <mat-option *ngFor="let obj  of liste_des_bd  " [value]="obj" (click)="setbasedonnees(obj.Name)"> {{ obj.Name }} </mat-option>

      </mat-select>
    </mat-form-field>
    <br>
    <mat-label style="color:black;font-size: 20px;">Select a fact table </mat-label>
    <mat-form-field >
     
      <mat-select disableRipple id="selectedTables" [(ngModel)]="selectedTables" name="selectedTables">
        <mat-option *ngFor="let obj  of liste_des_table  " [value]="obj" (click)="settable(obj.Name)"> {{ obj.Name }} </mat-option>
      </mat-select>
    </mat-form-field>
    <br>

  

    <mat-label style="color:black;font-size: 20px;">Select Dimenssion(s) </mat-label>
    <mat-form-field>
      <mat-select [(ngModel)]="selectedObjects" [compareWith]="comparer" >
        <mat-option *ngFor="let el of liste_des_dim" [value]="el" (click)="setAtrFact(el.Name)"  >
          {{el.Name}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <br>

    <!-- <mat-form-field>
      <mat-label>Select attributes</mat-label>
      <mat-select multiple>
        <mat-optgroup *ngFor="let group of res" [label]="group.key">
          <mat-option *ngFor="let at of group.liste">{{at.name}}</mat-option>
        </mat-optgroup>
      </mat-select>

    </mat-form-field>
    <br />  -->
    <mat-label style="color:black;font-size: 20px;" > Please add relation(s) between fact and dimenssions  </mat-label>
    <div style="display: flex  ; width: 80%;">
      <section  >
        <mat-form-field>
         
          <mat-select    [compareWith]="comparer" >
            <mat-option *ngFor="let el of liste1 " [value]="el" (click)="setselect1(el)" >
              {{el.Name}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </section>
      
      <section  style="margin-left: 5%;">
        <mat-form-field>
         
          <mat-select    [compareWith]="comparer" >
            <mat-option *ngFor="let el of liste2 " [value]="el" (click)="setselect2(el)" >
              {{el.Name}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </section>
   
      <button type="button" class="btn btn-dark" [disabled]="obj1 == null || obj2 == null"  (click)="match()" style=" margin-left:100px; width: 300PX;"> Matching </button>


    </div>
 
    <br>
    <br>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>dim</th>
        <th>id_dim</th>
        <th>fact</th>
        <th>cle_fact</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let obj of resultat_de_selection">
        <td>{{ obj.obj1.TableName }}</td>
        <td>{{ obj.obj1.Name }}</td>
        <td>{{ this.fact_name }}</td>
        <td>{{ obj.obj2.Name }}</td>
        <td> <mat-icon>create</mat-icon> <br> <mat-icon>clear</mat-icon> </td>
      </tr>
    </tbody>
  </table>
  <br>
  <br>
   <mat-label style="color:black;font-size: 20px;" > Please Select a Mesure  </mat-label>
  <div style="display: flex  ; width: 80%;">
    <section  >
      <mat-form-field>
       
        <mat-select    [compareWith]="comparer" >
          <mat-option *ngFor="let el of liste1 " [value]="el" (click)="setselect1(el)" >
            {{el.Name}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </section>
    
    <section  style="margin-left: 5%;">
      <mat-form-field>
       
        <mat-select    [compareWith]="comparer" >
          <mat-option *ngFor="let el of liste2 " [value]="el" (click)="setselect2(el)" >
            {{el.Name}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </section>
 
    <button type="button" class="btn btn-dark" [disabled]="obj1 == null || obj2 == null"  (click)="match()" style=" margin-left:100px; width: 300PX;"> Add </button>


  </div>
  <br>
  <br>
  <mat-label style="color:black;font-size: 20px;"> Please Set a Name For the Cube </mat-label>
        <mat-form-field class="example-full-width">
    <br>
         
          <input matInput  [(ngModel)]="Cubename">
        </mat-form-field>
        <br>
        <br>
    <button    type="button" class="btn btn-danger" [disabled]="Cubename == null"  (click)="envoyer_data()" style="width:80% ; margin: top 30px; margin-left: 120PX; text-align: center ; text-size-adjust:3px ;">
      <h2> Generate Your Cube  </h2>
    </button>
  </div>
  


  </div>

  
 


